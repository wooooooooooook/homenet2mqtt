meta:
  name: "☑️환기시스템 설정"
  name_en: "☑️Ventilation System"
  description: "현대 이마주 환기시스템 설정입니다. 3단 속도를 지원합니다."
  description_en: "Hyundai Imazu ventilation system with 3-speed control."
  version: "1.0.0"
  author: "wooooooooooook"
  tags: ["fan", "ventilation", "hyundai", "imazu"]

entities:
  fan:
    - name: 'Room 1 Fan 1'
      speed_cnt: 3
      state:
        data: [0x00, 0x01, 0x2b, 0x04, 0x40, 0x11]
        mask: [0x00, 0xff, 0xff, 0xff, 0xff, 0xff]
      state_on:
        offset: 7
        data: [0x01]
      state_off:
        offset: 7
        data: [0x02]
      command_on:
        data: [0x0b, 0x01, 0x2b, 0x02, 0x40, 0x11, 0x01, 0x00]
        ack: [0x0c, 0x01, 0x2b, 0x04, 0x40, 0x11, 0x01, 0x01, 0x07]
      command_off:
        data: [0x0b, 0x01, 0x2b, 0x02, 0x40, 0x11, 0x02, 0x00]
        ack: [0x0c, 0x01, 0x2b, 0x04, 0x40, 0x11, 0x02, 0x02, 0x00]
      command_speed: >-
        x == 3 ? [[0x0b, 0x01, 0x2b, 0x02, 0x40, 0x11, 0x01, 0x00], [0x0c, 0x01, 0x2b, 0x04, 0x40, 0x11, 0x01, 0x01, 0x07]] :
        (x == 2 ? [[0x0b, 0x01, 0x2b, 0x02, 0x42, 0x11, 0x03, 0x00], [0x0c, 0x01, 0x2b, 0x04, 0x40, 0x11, 0x01, 0x01, 0x03]] :
        (x == 1 ? [[0x0b, 0x01, 0x2b, 0x02, 0x42, 0x11, 0x01, 0x00], [0x0c, 0x01, 0x2b, 0x04, 0x40, 0x11, 0x01, 0x01, 0x01]] :
        []))
      state_speed: >-
        data[8] == 0x01 ? 1 : (data[8] == 0x03 ? 2 : (data[8] == 0x07 ? 3 : 0))
