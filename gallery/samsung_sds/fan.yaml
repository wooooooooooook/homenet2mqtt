meta:
  name: "환기팬 설정"
  name_en: "Ventilator"
  description: "삼성 SDS 환기팬 설정입니다. 3단 속도를 지원합니다."
  description_en: "Samsung SDS ventilator with 3-speed control."
  version: "2.0.0"
  author: "wooooooooooook"
  tags: ["fan", "ventilation", "samsung", "sds"]

discovery:
  match:
    data: [0xB0, 0x4E]
    mask: [0xFF, 0xFF]
  ui:
    label: "환기팬"
    label_en: "Ventilator"
    summary: "환기팬 발견됨"
    summary_en: "Ventilator discovered"

entities:
  fan:
    - id: 'ventilator'
      name: 'Ventilator'
      state:
        data: [0xB0,0x4E]
      state_on:
        offset: 4
        data: [0x00]
      state_off:
        offset: 4
        data: [0x01]
      state_speed: >-
        data[2] == 0x03 ? 1 : (data[2] == 0x02 ? 2 : (data[2] == 0x01 ? 3 : 0))
      command_on:
        data: [0xC2, 0x4F, 0x05, 0x00, 0x00]
        ack: [0xB0, 0x4F, 0x05]
      command_off:
        data: [0xC2, 0x4F, 0x06, 0x00, 0x00]
        ack: [0xB0, 0x4F, 0x06]
      command_speed: >-
        [[0xC2, 0x4F, 0x04 - x, 0x00, 0x00],[0xB0, 0x4F, 0x04 - x]]
