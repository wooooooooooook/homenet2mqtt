import { describe, it, expect } from 'vitest';

describe('Checksum Verification', () => {
  it('should verify checksums for user packets', () => {
    const packets = [
      [0x02, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06],
      [0x82, 0x80, 0x04, 0x22, 0x15, 0x00, 0x00, 0x3d],
      [0x02, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05],
      [0x82, 0x81, 0x02, 0x24, 0x15, 0x00, 0x00, 0x3e],
      [0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03],
      [0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f],
      [0x8f, 0x0f, 0x03, 0x05, 0x40, 0x04, 0x00, 0xea],
      [0x10, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11],
      [0x30, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38],
      [0x30, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x36],
      [0x30, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x37],
      [0x30, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x35],
      [0x30, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x34],
      [0x30, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x33],
      [0x30, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x32],
      [0x30, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x31],
    ];

    for (const packet of packets) {
      let sum = 0;
      for (let i = 0; i < 7; i++) {
        sum = (sum + packet[i]) & 0xff;
      }
      const expectedChecksum = packet[7];
      expect(sum).toBe(expectedChecksum);
    }
  });
});
