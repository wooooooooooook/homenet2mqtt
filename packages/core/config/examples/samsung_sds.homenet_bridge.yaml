homenet_bridge:
  serial:
    portId: samsung_sds
    path: 192.168.0.83:8888
    baud_rate: 9600
    data_bits: 8
    parity: EVEN
    stop_bits: 1

  packet_defaults:
    rx_timeout: 10ms
    tx_delay: 10ms
    tx_timeout: 200ms
    tx_retry_cnt: 5
    rx_checksum: samsung_xor
    tx_checksum: samsung_xor
    rx_valid_headers: [0xB0, 0xAB, 0xAD, 0xCC, 0xA4]
    # B0: 장치 응답(상태), AB: 가스밸브, AD: 현관스위치(구형), CC: 현관스위치(신형), A4: 인터폰

  light:
    - id: 'light_1'
      name: 'Light 1'
      state:
        data: [0xB0, 0x79, 0x21]
      state_on:
        offset: 3
        data: [0x01]
        mask: [0x01]
      state_off:
        offset: 3
        data: [0x00]
        mask: [0x01]
      command_on:
        data: [0xAC, 0x7A, 0x01, 0x01]
        ack: [0xB0, 0x79, 0x01, 0x01]
      command_off:
        data: [0xAC, 0x7A, 0x01, 0x00]
        ack: [0xB0, 0x79, 0x01, 0x00]

    - id: 'light_2'
      name: 'Light 2'
      state:
        data: [0xB0, 0x79, 0x13]
      state_on:
        offset: 3
        data: [0x02]
        mask: [0x02]
      state_off:
        offset: 3
        data: [0x00]
        mask: [0x02]
      command_on:
        data: [0xAC, 0x7A, 0x03, 0x01]
        ack: [0xB0, 0x79, 0x03, 0x01]
      command_off:
        data: [0xAC, 0x7A, 0x03, 0x00]
        ack: [0xB0, 0x79, 0x03, 0x00]

  climate:
    - id: 'room_0_heater'
      name: 'Room 0 Heater'
      packet_defaults:
        rx_checksum: xor
      visual:
        min_temperature: 5 °C
        max_temperature: 40 °C
        temperature_step: 1 °C
      state:
        data: [0xB0, 0x7C, 0x01]
      state_temperature_current:
        offset: 5
        length: 1
      state_temperature_target:
        offset: 4
        length: 1
      state_off:
        offset: 3
        data: [0x00]
        mask: [0x01]
      state_heat:
        offset: 3
        data: [0x01]
        mask: [0x01]
      command_off:
        data: [0xAE, 0x7D, 0x01, 0x00, 0x00, 0x00, 0x00]
        ack: [0xB0, 0x7D, 0x01, 0x00]
      command_heat:
        data: [0xAE, 0x7D, 0x01, 0x01, 0x00, 0x00, 0x00]
        ack: [0xB0, 0x7D, 0x01, 0x01]
      command_temperature: >-
        [[0xAE, 0x7F, 0x01, x, 0x00, 0x00, 0x00],[0xB0, 0x7F, 0x01, x]]
      state_action: >-
        data[3] == 0x00 ? 'off' : (data[4] > data[5] ? 'heating' : 'idle')

    - id: 'room_1_heater'
      name: 'Room 1 Heater'
      visual:
        min_temperature: 5 °C
        max_temperature: 40 °C
        temperature_step: 1 °C
      state:
        data: [0xB0, 0x7C, 0x02]
      state_temperature_current:
        offset: 5
        length: 1
      state_temperature_target:
        offset: 4
        length: 1
      state_off:
        offset: 3
        data: [0x00]
        mask: [0x01]
      state_heat:
        offset: 3
        data: [0x01]
        mask: [0x01]
      command_off:
        data: [0xAE, 0x7D, 0x02, 0x00, 0x00, 0x00, 0x00]
        ack: [0xB0, 0x7D, 0x02, 0x00]
      command_heat:
        data: [0xAE, 0x7D, 0x02, 0x01, 0x00, 0x00, 0x00]
        ack: [0xB0, 0x7D, 0x02, 0x01]
      command_temperature: >-
        [[0xAE, 0x7F, 0x02, x, 0x00, 0x00, 0x00],[0xB0, 0x7F, 0x02, x]]
      state_action: >-
        data[3] == 0x00 ? 'off' : (data[4] > data[5] ? 'heating' : 'idle')

  fan:
    - id: 'ventilator'
      name: 'Ventilator'
      state:
        data: [0xB0, 0x4E]
      state_on:
        offset: 4
        data: [0x00]
      state_off:
        offset: 4
        data: [0x01]
      state_speed: >-
        data[2] == 0x03 ? 1 : (data[2] == 0x02 ? 2 : (data[2] == 0x01 ? 3 : 0))
      command_on:
        data: [0xC2, 0x4F, 0x05, 0x00, 0x00]
        ack: [0xB0, 0x4F, 0x05]
      command_off:
        data: [0xC2, 0x4F, 0x06, 0x00, 0x00]
        ack: [0xB0, 0x4F, 0x06]
      command_speed: >-
        [[0xC2, 0x4F, 0x04 - x, 0x00, 0x00],[0xB0, 0x4F, 0x04 - x]]

  switch:
    # Outlet 1
    - id: 'outlet_1'
      name: 'Outlet 1'
      icon: 'mdi:power-socket-eu'
      state:
        data: [0xB0, 0x4A, 0x01]
      state_on:
        offset: 3
        data: [0x01]
        mask: [0x0F]
      state_off:
        offset: 3
        data: [0x00]
        mask: [0x0F]
      command_on:
        data: [0xC6, 0x6E, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]
        ack: [0xB0, 0x6E, 0x01]
      command_off:
        data: [0xC6, 0x6E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
        ack: [0xB0, 0x6E, 0x01]

    - id: 'outlet_1_standby_cutoff'
      name: 'Outlet 1 standby cutoff'
      icon: 'mdi:leaf-circle-outline'
      state:
        data: [0xB0, 0x4A, 0x01]
      state_on:
        offset: 3
        data: [0x10]
        mask: [0xF0]
      state_off:
        offset: 3
        data: [0x00]
        mask: [0xF0]
      command_on:
        data: [0xC6, 0x4B, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]
        ack: [0xB0, 0x4B, 0x01, 0x01]
      command_off:
        data: [0xC6, 0x4B, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
        ack: [0xB0, 0x4B, 0x01, 0x00]

  sensor:
    - id: 'outlet_1_power'
      name: 'Outlet 1 Power'
      device_class: 'power'
      state_class: 'measurement'
      unit_of_measurement: 'W'
      icon: 'mdi:lightning-bolt'
      state:
        data: [0xB0, 0x4A, 0x01]
      state_number:
        offset: 4
        length: 2
