var Ee=Object.defineProperty;var Se=(t,e,n)=>e in t?Ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ue=(t,e,n)=>Se(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const o of u.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(l){if(l.ep)return;l.ep=!0;const u=n(l);fetch(l.href,u)}})();function $(){}function Ce(t){return t()}function ae(){return Object.create(null)}function x(t){t.forEach(Ce)}function we(t){return typeof t=="function"}function De(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Ae(t){return Object.keys(t).length===0}function s(t,e){t.appendChild(e)}function K(t,e,n){t.insertBefore(e,n||null)}function V(t){t.parentNode&&t.parentNode.removeChild(t)}function Le(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function a(t){return document.createElement(t)}function O(t){return document.createTextNode(t)}function B(){return O(" ")}function Pe(){return O("")}function ne(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function Te(t){return function(e){return e.preventDefault(),t.call(this,e)}}function c(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ve(t){return t===""?null:+t}function Oe(t){return Array.from(t.childNodes)}function j(t,e){e=""+e,t.data!==e&&(t.data=e)}function G(t,e){t.value=e??""}let se;function le(t){se=t}function Me(){if(!se)throw new Error("Function called outside component initialization");return se}function Ne(t){Me().$$.on_destroy.push(t)}const Y=[],fe=[];let Z=[];const de=[],Re=Promise.resolve();let ie=!1;function He(){ie||(ie=!0,Re.then(be))}function ce(t){Z.push(t)}const oe=new Set;let W=0;function be(){if(W!==0)return;const t=se;do{try{for(;W<Y.length;){const e=Y[W];W++,le(e),Ue(e.$$)}}catch(e){throw Y.length=0,W=0,e}for(le(null),Y.length=0,W=0;fe.length;)fe.pop()();for(let e=0;e<Z.length;e+=1){const n=Z[e];oe.has(n)||(oe.add(n),n())}Z.length=0}while(Y.length);for(;de.length;)de.pop()();ie=!1,oe.clear(),le(t)}function Ue(t){if(t.fragment!==null){t.update(),x(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ce)}}function Fe(t){const e=[],n=[];Z.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Z=e}const je=new Set;function Be(t,e){t&&t.i&&(je.delete(t),t.i(e))}function re(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function qe(t,e){t.d(1),e.delete(t.key)}function Ie(t,e,n,r,l,u,o,_,g,p,b,m){let h=t.length,v=u.length,C=h;const k={};for(;C--;)k[t[C].key]=C;const A=[],L=new Map,E=new Map,M=[];for(C=v;C--;){const d=m(l,u,C),i=n(d);let f=o.get(i);f?M.push(()=>f.p(d,e)):(f=p(i,d),f.c()),L.set(i,A[C]=f),i in k&&E.set(i,Math.abs(C-k[i]))}const N=new Set,R=new Set;function P(d){Be(d,1),d.m(_,b),o.set(d.key,d),b=d.first,v--}for(;h&&v;){const d=A[v-1],i=t[h-1],f=d.key,w=i.key;d===i?(b=d.first,h--,v--):L.has(w)?!o.has(f)||N.has(f)?P(d):R.has(w)?h--:E.get(f)>E.get(w)?(R.add(f),P(d)):(N.add(w),h--):(g(i,o),h--)}for(;h--;){const d=t[h];L.has(d.key)||g(d,o)}for(;v;)P(A[v-1]);return x(M),A}function Qe(t,e,n){const{fragment:r,after_update:l}=t.$$;r&&r.m(e,n),ce(()=>{const u=t.$$.on_mount.map(Ce).filter(we);t.$$.on_destroy?t.$$.on_destroy.push(...u):x(u),t.$$.on_mount=[]}),l.forEach(ce)}function Ve(t,e){const n=t.$$;n.fragment!==null&&(Fe(n.after_update),x(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Je(t,e){t.$$.dirty[0]===-1&&(Y.push(t),He(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ze(t,e,n,r,l,u,o=null,_=[-1]){const g=se;le(t);const p=t.$$={fragment:null,ctx:[],props:u,update:$,not_equal:l,bound:ae(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(g?g.$$.context:[])),callbacks:ae(),dirty:_,skip_bound:!1,root:e.target||g.$$.root};o&&o(p.root);let b=!1;if(p.ctx=n?n(t,e.props||{},(m,h,...v)=>{const C=v.length?v[0]:h;return p.ctx&&l(p.ctx[m],p.ctx[m]=C)&&(!p.skip_bound&&p.bound[m]&&p.bound[m](C),b&&Je(t,m)),h}):[],p.update(),b=!0,x(p.before_update),p.fragment=r?r(p.ctx):!1,e.target){if(e.hydrate){const m=Oe(e.target);p.fragment&&p.fragment.l(m),m.forEach(V)}else p.fragment&&p.fragment.c();e.intro&&Be(t.$$.fragment),Qe(t,e.target,e.anchor),be()}le(g)}class Ke{constructor(){ue(this,"$$");ue(this,"$$set")}$destroy(){Ve(this,1),this.$destroy=$}$on(e,n){if(!we(n))return $;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const l=r.indexOf(n);l!==-1&&r.splice(l,1)}}$set(e){this.$$set&&!Ae(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Xe="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Xe);function pe(t,e,n){const r=t.slice();return r[20]=e[n],r}function he(t,e,n){const r=t.slice();return r[23]=e[n],r[25]=n,r}function Ge(t){let e,n,r,l,u,o,_,g,p=(t[8]||"패킷을 기다리는 중입니다.")+"",b,m,h,v,C,k,A,L,E,M=(t[0]||"입력되지 않음")+"",N,R,P,d,i,f,w,H,U,J,ee,I,z,te,q,X,Q;function T(y,F){return y[6].length===0?Ze:Ye}let S=T(t),D=S(t);return{c(){e=a("section"),n=a("header"),r=a("div"),r.innerHTML='<p class="eyebrow svelte-13w5sy1">실시간 RS485 패킷 뷰어</p> <h1 class="svelte-13w5sy1">homenet/raw 구독</h1>',l=B(),u=a("div"),o=a("span"),_=B(),g=a("span"),b=O(p),m=B(),h=a("button"),h.textContent="설정 변경",v=B(),C=a("div"),k=a("div"),A=a("span"),A.textContent="Serial Path",L=B(),E=a("strong"),N=O(M),R=B(),P=a("div"),d=a("span"),d.textContent="Baud Rate",i=B(),f=a("strong"),w=O(t[1]),H=B(),U=a("div"),J=a("span"),J.textContent="MQTT URL",ee=B(),I=a("strong"),z=O(t[2]),te=B(),q=a("div"),D.c(),c(o,"class","dot svelte-13w5sy1"),c(u,"class","status svelte-13w5sy1"),c(u,"data-state",t[7]),c(h,"class","ghost svelte-13w5sy1"),c(h,"type","button"),c(n,"class","viewer-header svelte-13w5sy1"),c(A,"class","label svelte-13w5sy1"),c(d,"class","label svelte-13w5sy1"),c(J,"class","label svelte-13w5sy1"),c(C,"class","viewer-meta svelte-13w5sy1"),c(q,"class","packet-list svelte-13w5sy1"),c(e,"class","panel viewer svelte-13w5sy1")},m(y,F){K(y,e,F),s(e,n),s(n,r),s(n,l),s(n,u),s(u,o),s(u,_),s(u,g),s(g,b),s(n,m),s(n,h),s(e,v),s(e,C),s(C,k),s(k,A),s(k,L),s(k,E),s(E,N),s(C,R),s(C,P),s(P,d),s(P,i),s(P,f),s(f,w),s(C,H),s(C,U),s(U,J),s(U,ee),s(U,I),s(I,z),s(e,te),s(e,q),D.m(q,null),X||(Q=ne(h,"click",t[12]),X=!0)},p(y,F){F&256&&p!==(p=(y[8]||"패킷을 기다리는 중입니다.")+"")&&j(b,p),F&128&&c(u,"data-state",y[7]),F&1&&M!==(M=(y[0]||"입력되지 않음")+"")&&j(N,M),F&2&&j(w,y[1]),F&4&&j(z,y[2]),S===(S=T(y))&&D?D.p(y,F):(D.d(1),D=S(y),D&&(D.c(),D.m(q,null)))},d(y){y&&V(e),D.d(),X=!1,Q()}}}function We(t){let e,n,r,l,u,o,_,g,p,b,m,h,v,C,k,A,L,E,M=t[4]==="loading"?"브리지를 시작하는 중...":"Start Bridge & View Packets",N,R,P,d,i=t[3]&&ye(t);return{c(){e=a("section"),n=a("h1"),n.textContent="RS485 HomeNet Bridge",r=B(),l=a("form"),u=a("label"),o=O(`Serial Path
          `),_=a("input"),g=B(),p=a("label"),b=O(`Baud Rate
          `),m=a("input"),h=B(),v=a("label"),C=O(`MQTT URL
          `),k=a("input"),A=B(),i&&i.c(),L=B(),E=a("button"),N=O(M),c(n,"class","svelte-13w5sy1"),c(_,"placeholder","/simshare/rs485-sim-tty"),c(_,"class","svelte-13w5sy1"),c(u,"class","svelte-13w5sy1"),c(m,"type","number"),c(m,"min","0"),c(m,"step","1"),c(m,"class","svelte-13w5sy1"),c(p,"class","svelte-13w5sy1"),c(k,"placeholder","mqtt://mq:1883"),c(k,"class","svelte-13w5sy1"),c(v,"class","svelte-13w5sy1"),c(E,"type","submit"),E.disabled=R=t[4]==="loading",c(E,"class","svelte-13w5sy1"),c(l,"class","form svelte-13w5sy1"),c(e,"class","panel svelte-13w5sy1")},m(f,w){K(f,e,w),s(e,n),s(e,r),s(e,l),s(l,u),s(u,o),s(u,_),G(_,t[0]),s(l,g),s(l,p),s(p,b),s(p,m),G(m,t[1]),s(l,h),s(l,v),s(v,C),s(v,k),G(k,t[2]),s(l,A),i&&i.m(l,null),s(l,L),s(l,E),s(E,N),P||(d=[ne(_,"input",t[13]),ne(m,"input",t[14]),ne(k,"input",t[15]),ne(l,"submit",Te(t[9]))],P=!0)},p(f,w){w&1&&_.value!==f[0]&&G(_,f[0]),w&2&&ve(m.value)!==f[1]&&G(m,f[1]),w&4&&k.value!==f[2]&&G(k,f[2]),f[3]?i?i.p(f,w):(i=ye(f),i.c(),i.m(l,L)):i&&(i.d(1),i=null),w&16&&M!==(M=f[4]==="loading"?"브리지를 시작하는 중...":"Start Bridge & View Packets")&&j(N,M),w&16&&R!==(R=f[4]==="loading")&&(E.disabled=R)},d(f){f&&V(e),i&&i.d(),P=!1,x(d)}}}function Ye(t){let e=[],n=new Map,r,l=re([...t[6]].reverse());const u=o=>o[20].receivedAt+o[20].payloadHex;for(let o=0;o<l.length;o+=1){let _=pe(t,l,o),g=u(_);n.set(g,e[o]=me(g,_))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();r=Pe()},m(o,_){for(let g=0;g<e.length;g+=1)e[g]&&e[g].m(o,_);K(o,r,_)},p(o,_){_&3136&&(l=re([...o[6]].reverse()),e=Ie(e,_,u,1,o,l,n,r.parentNode,qe,me,r,pe))},d(o){o&&V(r);for(let _=0;_<e.length;_+=1)e[_].d(o)}}}function Ze(t){let e;return{c(){e=a("p"),e.textContent="아직 수신된 패킷이 없습니다.",c(e,"class","empty svelte-13w5sy1")},m(n,r){K(n,e,r)},p:$,d(n){n&&V(e)}}}function _e(t){let e,n=t[23]+"",r;return{c(){e=a("span"),r=O(n),c(e,"class","byte svelte-13w5sy1"),c(e,"title",`byte ${t[25]}`)},m(l,u){K(l,e,u),s(e,r)},p(l,u){u&64&&n!==(n=l[23]+"")&&j(r,n)},d(l){l&&V(e)}}}function me(t,e){let n,r,l,u=new Date(e[20].receivedAt).toLocaleTimeString()+"",o,_,g,p=e[20].topic+"",b,m,h,v=e[20].payloadLength+"",C,k,A,L,E,M,N,R=e[11](e[20].payload)+"",P,d,i,f,w,H,U=e[20].payloadHex.toUpperCase()+"",J,ee,I,z,te,q,X,Q=re(e[10](e[20].payloadHex)),T=[];for(let S=0;S<Q.length;S+=1)T[S]=_e(he(e,Q,S));return{key:t,first:null,c(){n=a("article"),r=a("header"),l=a("span"),o=O(u),_=B(),g=a("span"),b=O(p),m=B(),h=a("span"),C=O(v),k=O(" bytes"),A=B(),L=a("div"),E=a("span"),E.textContent="ASCII",M=B(),N=a("code"),P=O(R),d=B(),i=a("div"),f=a("span"),f.textContent="HEX",w=B(),H=a("code"),J=O(U),ee=B(),I=a("div"),z=a("span"),z.textContent="RS485 Bytes",te=B(),q=a("div");for(let S=0;S<T.length;S+=1)T[S].c();X=B(),c(l,"class","time"),c(g,"class","topic svelte-13w5sy1"),c(h,"class","length svelte-13w5sy1"),c(r,"class","svelte-13w5sy1"),c(E,"class","svelte-13w5sy1"),c(N,"class","svelte-13w5sy1"),c(L,"class","payload svelte-13w5sy1"),c(f,"class","svelte-13w5sy1"),c(H,"class","svelte-13w5sy1"),c(i,"class","payload svelte-13w5sy1"),c(z,"class","svelte-13w5sy1"),c(q,"class","byte-grid svelte-13w5sy1"),c(I,"class","payload bytes svelte-13w5sy1"),c(n,"class","packet svelte-13w5sy1"),this.first=n},m(S,D){K(S,n,D),s(n,r),s(r,l),s(l,o),s(r,_),s(r,g),s(g,b),s(r,m),s(r,h),s(h,C),s(h,k),s(n,A),s(n,L),s(L,E),s(L,M),s(L,N),s(N,P),s(n,d),s(n,i),s(i,f),s(i,w),s(i,H),s(H,J),s(n,ee),s(n,I),s(I,z),s(I,te),s(I,q);for(let y=0;y<T.length;y+=1)T[y]&&T[y].m(q,null);s(n,X)},p(S,D){if(e=S,D&64&&u!==(u=new Date(e[20].receivedAt).toLocaleTimeString()+"")&&j(o,u),D&64&&p!==(p=e[20].topic+"")&&j(b,p),D&64&&v!==(v=e[20].payloadLength+"")&&j(C,v),D&64&&R!==(R=e[11](e[20].payload)+"")&&j(P,R),D&64&&U!==(U=e[20].payloadHex.toUpperCase()+"")&&j(J,U),D&1088){Q=re(e[10](e[20].payloadHex));let y;for(y=0;y<Q.length;y+=1){const F=he(e,Q,y);T[y]?T[y].p(F,D):(T[y]=_e(F),T[y].c(),T[y].m(q,null))}for(;y<T.length;y+=1)T[y].d(1);T.length=Q.length}},d(S){S&&V(n),Le(T,S)}}}function ye(t){let e,n;return{c(){e=a("p"),n=O(t[3]),c(e,"class","error svelte-13w5sy1")},m(r,l){K(r,e,l),s(e,n)},p(r,l){l&8&&j(n,r[3])},d(r){r&&V(e)}}}function $e(t){let e;function n(u,o){return u[5]==="form"?We:Ge}let r=n(t),l=r(t);return{c(){e=a("main"),l.c(),c(e,"class","svelte-13w5sy1")},m(u,o){K(u,e,o),l.m(e,null)},p(u,[o]){r===(r=n(u))&&l?l.p(u,o):(l.d(1),l=r(u),l&&(l.c(),l.m(e,null)))},i:$,o:$,d(u){u&&V(e),l.d()}}}function ge(t){try{return JSON.parse(t)}catch{return null}}function xe(t,e,n){let r="/simshare/rs485-sim-tty",l=9600,u="mqtt://mq:1883",o="",_="idle",g="form",p=[],b=null,m="idle",h="";async function v(){if(_!=="loading"){n(3,o=""),n(4,_="loading");try{const d=await fetch("/api/bridge/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serialPath:r,baudRate:l,mqttUrl:u})});if(!d.ok){const i=await d.text();let f=i;try{const w=JSON.parse(i);w&&typeof w=="object"&&"error"in w&&(f=String(w.error??i))}catch{}throw new Error(f||"브리지를 시작하지 못했습니다.")}C()}catch(d){d instanceof Error?n(3,o=d.message):n(3,o="알 수 없는 오류가 발생했습니다.")}finally{n(4,_="idle")}}}function C(){n(5,g="viewer"),n(6,p=[]),k()}function k(){if(typeof window>"u")return;A(),n(7,m="connecting"),n(8,h="MQTT 연결을 시도하는 중입니다...");const d=new URL("/api/packets/stream",window.location.origin);u.trim().length>0&&d.searchParams.set("mqttUrl",u.trim()),b=new EventSource(d.toString());const i=w=>{const H=ge(w.data);if(!H)return;const U=H.state;U==="connected"?(n(7,m="connected"),n(8,h="MQTT 연결 완료")):U==="subscribed"?(n(7,m="connected"),n(8,h=`'${H.topic}' 구독 중`)):U==="error"?(n(7,m="error"),n(8,h=typeof H.message=="string"?H.message:"패킷 스트림 오류가 발생했습니다.")):U==="connecting"&&(n(7,m="connecting"),n(8,h="MQTT 연결을 시도하는 중입니다..."))},f=w=>{const H=ge(w.data);H&&n(6,p=[...p,H].slice(-100))};b.addEventListener("status",i),b.addEventListener("packet",f),b.onerror=()=>{n(7,m="error"),n(8,h="스트림 연결이 끊어졌습니다. 잠시 후 다시 시도하세요.")}}function A(){b&&(b.close(),b=null),n(7,m="idle"),n(8,h="")}const L=d=>{var i;return((i=d.match(/.{1,2}/g))==null?void 0:i.map(f=>f.toUpperCase()))??[]},E=d=>d.split("").map(i=>{const f=i.charCodeAt(0);return f>=32&&f<=126?i:i===`
`?"⏎":i==="\r"?"↵":i==="	"?"⇥":"·"}).join("");function M(){A(),n(5,g="form")}Ne(A);function N(){r=this.value,n(0,r)}function R(){l=ve(this.value),n(1,l)}function P(){u=this.value,n(2,u)}return[r,l,u,o,_,g,p,m,h,v,L,E,M,N,R,P]}class et extends Ke{constructor(e){super(),ze(this,e,xe,$e,De,{})}}const ke=document.getElementById("app");if(!ke)throw new Error("Failed to find app element");new et({target:ke});
